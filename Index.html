<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Employee Table</title>

    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/2.0.8/css/dataTables.bootstrap4.css">
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/3.0.2/css/buttons.bootstrap4.min.css">

    <link href="https://cdn.datatables.net/buttons/3.0.2/css/buttons.dataTables.css" rel="stylesheet" />



</head>
<body>
    <div class="container" style="margin-top: 20px">
        <div class="row">
            <div class="col-sm-12">
                
                <h2 class="text-center">Employee Information</h2>
                <table id="example" class="table table-striped table-bordered" style="width:100%">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Position</th>
                            <th>Office</th>
                            <th>Percentage</th>
                            <th>Start date</th>
                            <th>Salary</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Tiger Nixon</td>
                            <td>System Architect</td>
                            <td>Edinburgh</td>
                            <td>61%</td>
                            <td>2011-04-25</td>
                            <td>$320,800</td>
                        </tr>
                        <tr>
                            <td>Garrett Winters</td>
                            <td>Accountant</td>
                            <td>Tokyo</td>
                            <td>63%</td>
                            <td>2011-07-25</td>
                            <td>$170,750</td>
                        </tr>
                        <tr>
                            <td>Ashton Cox</td>
                            <td>Junior Technical Author</td>
                            <td>San Francisco</td>
                            <td>66%</td>
                            <td>2009-01-12</td>
                            <td>$86,000</td>
                        </tr>
                        <tr>
                            <td>Cedric Kelly</td>
                            <td>Senior Javascript Developer</td>
                            <td>Edinburgh</td>
                            <td>22.05%</td>
                            <td>2012-03-29</td>
                            <td>$433,060</td>
                        </tr>
                        <tr>
                            <td>Airi Satou</td>
                            <td>Accountant</td>
                            <td>Tokyo</td>
                            <td>0.16%</td>
                            <td>2008-11-28</td>
                            <td>$162,700</td>
                        </tr>
                        <tr>
                            <td>Brielle Williamson</td>
                            <td>Integration Specialist</td>
                            <td>New York</td>
                            <td>100%</td>
                            <td>2012-12-02</td>
                            <td>$372,000</td>
                        </tr>
                        <tr>
                            <td>Herrod Chandler</td>
                            <td>Sales Assistant</td>
                            <td>San Francisco</td>
                            <td>0%</td>
                            <td>2012-08-06</td>
                            <td>$137,500</td>
                        </tr>
                    </tbody>

                </table>
                <!-- <table id="example" class="table table-bordered" style="width: 100%">
                  <thead>
                    <tr>
                      <th rowspan="2">Roll No</th>
                      <th rowspan="2">Name</th>
                      <th>Assessment</th>
                      <th>Sessional 2</th>
                      <th>Final</th>
                      <th>Grand Total</th>
                    </tr>
                    <tr>
                      <th>Date</th>
                      <th>9 Jun</th>
                      <th>25 Aug</th>
                      <th>18 Dec</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>123</td>
                      <td colspan="2">System Architect</td>
                      <td>2011-04-25</td>
                      <td>$320,800</td>
                      <td>$320,800</td>
                      <td style="display: none"></td>
                    </tr>
                    <tr>
                      <td>456</td>
                      <td colspan="2">Accountant</td>
                      <td>2011-07-25</td>
                      <td>$170,750</td>
                      <td>$170,750</td>
                      <td style="display: none"></td>
                    </tr>
                  </tbody>
                </table> -->
            </div>
        </div>
    </div>
</body>
</html>


<!-- jQuery -->
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<!-- DataTables JS -->
<script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/4.0.0/js/jquery.dataTables.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.2/js/bootstrap.min.js" type="text/javascript"></script>
<script src="https://cdn.datatables.net/2.0.8/js/dataTables.js" type="text/javascript"></script>
<script src="https://cdn.datatables.net/2.0.8/js/dataTables.bootstrap4.js" type="text/javascript"></script>


<script src="https://cdn.datatables.net/buttons/3.0.2/js/dataTables.buttons.js"></script>
<script src="https://cdn.datatables.net/buttons/3.0.2/js/buttons.dataTables.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/3.0.2/js/buttons.html5.min.js"></script>

<script>
   
    $(document).ready(function () {

        $("#example").DataTable({

            layout: {
                topStart: {
                    buttons: [
                        {
                            extend: 'excelHtml5',
                            text: 'Export to Excel',
                            filename: 'Custom_Export',
                            title: 'Custom Export Title',
                            exportOptions: {
                                columns: ':visible', // Export only visible columns
                                format: {
                                    body: function (data, row, column, node) {
                                        var checkValue = checkValueType(data);
                                        if (checkValue == "F" && column == 3) { 
                                            let val = parseFloat(data);
                                            return `${val.toFixed(2)} %`;
                                        } else if (checkValue == "I" && column == 3) {
                                            let val = parseInt(data);
                                            return `${val.toFixed(0)} %`;
                                        }
                                        return data;
                                    }
                                }
                            },
                            customize: function (xlsx) {
                                
                                //var sSh = xlsx.xl['styles.xml'];
                                //var newPercentageFormat = sSh.childNodes[0].childNodes[0].childNodes[3].cloneNode(false);
                                //newPercentageFormat.setAttribute('formatCode', '0.00%');
                                //newPercentageFormat.setAttribute('numFmtId', '180');
                                //sSh.childNodes[0].childNodes[0].appendChild(newPercentageFormat);
                                //$(sSh).find('xf[numFmtId="9"]').attr('numFmtId', '180');

                                var sheet = xlsx.xl.worksheets['sheet1.xml'];
                                $('row c[r^="D"]', sheet).each(function () {
                                    var original = $('is t', this).text();
                                    debugger
                                    if (original.endsWith('%')) {
                                        debugger
                                        var newValue = original.replace(/\s*%\s*$/, '%');
                                        $('is t', this).text(newValue);
                                    }
                                });

                            }
                        },
                        'copyHtml5',
                        'csvHtml5',
                        'pdfHtml5'
                    ],
                }
            },
            scrollY: "300px",
            scrollX: true,
            scrollCollapse: true,
            paging: true,
            "bInfo": false, //Showing 1 to 4 of 4 entries disable
            "searching": false,
        });

    });


    function checkValueType(inputString) {
        // Regular expressions to match different types
        var floatRegex = /\d+\.\d+%?/;  // Matches float values (e.g., 0.16%)
        var intRegex = /\d+%?/;         // Matches integer values (e.g., 100%, 48%)

        // Regular expression for date in YYYY-MM-DD format
        const dateRegex = /^\d{4}-\d{2}-\d{2}$/;

        // Check for date (example format: dd/mm/yyyy)
        if (dateRegex.test(inputString)) {
            return 'D';
        }
        // Check for float
        if (floatRegex.test(inputString)) {
            return 'F';
        }
        // Check for integer
        if (intRegex.test(inputString)) {
            return 'I';
        }
        // If none of the above patterns matched
        return 'Unknown';
    }

</script>
